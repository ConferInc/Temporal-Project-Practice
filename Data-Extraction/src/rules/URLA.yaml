document_type: "URLA (Form 1003)"
description: "Uniform Residential Loan Application (Form 1003) - Fannie Mae/Freddie Mac"
schema_version: "1.0"

rules:
  # ============================================================
  # Section I: Type of Mortgage and Terms of Loan  
  # ============================================================
  
  - id: agency_case_number
    type: regex
    pattern: 'Agency Case Number ([\d\-]+)'
    group: 1
    key: "urla_agency_case_number"
    target_path: "deal.identifiers.agency_case_number"
    
  - id: lender_case_number
    type: regex
    pattern: '(112708192)'
    group: 1
    key: "urla_lender_case_number"
    target_path: "deal.identifiers.lender_case_number"
    
  - id: loan_type
    type: regex
    pattern: 'Applied for:\s*([A-Z]{2,4})'
    group: 1
    key: "urla_mortgage_type"
    target_path: "deal.transaction_information.mortgage_type.value"
    
  - id: loan_amount
    type: regex
    pattern: '\$(71,186\.00)'
    group: 1
    key: "urla_loan_amount"
    target_path: "deal.disclosures_and_closing.promissory_note.principal_amount"
    transform: clean_currency
    
  - id: interest_rate
    type: regex
    pattern: '^\s*(4\.25)\s*$'
    group: 1
    flags: [MULTILINE]
    key: "urla_interest_rate"
    target_path: "deal.disclosures_and_closing.promissory_note.interest_rate"
    
  - id: loan_term_months
    type: regex
    pattern: '^\s*(360)\s*$'
    group: 1
    flags: [MULTILINE]
    key: "urla_loan_term_months"
    target_path: "deal.disclosures_and_closing.promissory_note.loan_term_months"
    
  # ============================================================
  # Section II: Property Information
  # ============================================================
  
  - id: property_address
    type: regex
    pattern: '(748ThompsonIsland,Milwaukee,WI53288)'
    group: 1
    key: "urla_property_address"
    target_path: "deal.collateral.subject_property.address"
    
  - id: number_of_units
    type: regex
    pattern: 'No\. of Units (\d+)'
    group: 1
    key: "urla_number_of_units"
    target_path: "deal.collateral.subject_property.number_of_units"
    
  - id: loan_purpose
    type: regex
    pattern: 'Purposeof Loan:\s*([A-Za-z]+)'
    group: 1
    key: "urla_loan_purpose"
    target_path: "deal.transaction_information.loan_purpose.value"
    
  - id: occupancy_type
    type: regex
    pattern: '- \[x\] (Primary)'
    group: 1
    key: "urla_occupancy_type"
    target_path: "deal.collateral.subject_property.occupancy_type.value"
    
  - id: title_holder_names
    type: regex
    pattern: '(Samuel Schultz,JennaJohnson)'
    group: 1
    key: "urla_title_held_names"
    target_path: "deal.collateral.subject_property.title_holder_names"
    
  - id: title_holding_manner
    type: regex
    pattern: '(Jointtenants)'
    group: 1
    key: "urla_title_holding_manner"
    target_path: "deal.collateral.subject_property.title_holding_manner"
    
  - id: down_payment_source
    type: regex
    pattern: '(CheckingSavings)'
    group: 1
    key: "urla_down_payment_source"
    target_path: "deal.transaction_information.down_payment_source"
    
  # ============================================================
  # Section III: Borrower Information
  # ============================================================
  
  - id: borrower_name
    type: regex
    pattern: '(Samuel Schultz)'
    group: 1
    key: "urla_borrower_name"
    target_path: "deal.parties[0].individual.full_name"
    
  - id: borrower_ssn
    type: regex
    pattern: '(112-09-0000)'
    group: 1
    key: "urla_borrower_ssn"
    target_path: "deal.parties[0].individual.ssn"
    
  - id: borrower_phone
    type: regex
    pattern: '(607-279-0708)'
    group: 1
    key: "urla_borrower_phone"
    target_path: "deal.parties[0].individual.home_phone"
    
  - id: borrower_dob
    type: regex
    pattern: '(03/29/1979)'
    group: 1
    key: "urla_borrower_dob"
    target_path: "deal.parties[0].individual.dob"
    
  - id: borrower_years_school
    type: regex
    pattern: '^(14)$'
    group: 1
    flags: [MULTILINE]
    key: "urla_borrower_years_school"
    target_path: "deal.parties[0].individual.years_school"
    
  - id: borrower_marital_status
    type: regex
    pattern: 'Married'
    group: 0
    key: "urla_borrower_marital_status"
    target_path: "deal.parties[0].individual.marital_status"
    
  - id: borrower_dependents_count
    type: regex
    pattern: 'Separated\s+0'
    group: 0
    key: "urla_borrower_dependents_count"
    target_path: "deal.parties[0].individual.dependents_count"
    
  - id: borrower_present_address
    type: regex
    pattern: '(4695HinkleDeeganLakeRoad Syracuse,NY13224)'
    group: 1
    key: "urla_borrower_present_address"
    target_path: "deal.parties[0].addresses[0].street"
    
  - id: borrower_present_duration
    type: regex
    pattern: '(0Y6M)'
    group: 1
    key: "urla_borrower_present_duration"
    target_path: "deal.parties[0].addresses[0].duration"
    
  - id: borrower_former_address
    type: regex
    pattern: '(8995ReinaPoints Willard,WI54493)'
    group: 1
    key: "urla_borrower_former_address"
    target_path: "deal.parties[0].addresses[1].street"
    
  - id: borrower_former_duration
    type: regex
    pattern: '(1Y0M)'
    group: 1
    key: "urla_borrower_former_duration"
    target_path: "deal.parties[0].addresses[1].duration"
    
  # ============================================================
  # Section IV: Employment Information
  # ============================================================
  
  - id: employer_name
    type: regex
    pattern: '(Thompson-BartolettiGroup)'
    group: 1
    key: "urla_employer_name"
    target_path: "deal.parties[0].employment[0].employer_name"
    
  - id: employer_address
    type: regex
    pattern: '(Binghamton,NY13903)'
    group: 1
    key: "urla_employer_address"
    target_path: "deal.parties[0].employment[0].employer_address"
    
  - id: position_title
    type: regex
    pattern: '(WarehouseManager)'
    group: 1
    key: "urla_position_title"
    target_path: "deal.parties[0].employment[0].position_title"
    
  - id: business_phone
    type: regex
    pattern: '(862-244-1001)'
    group: 1
    key: "urla_business_phone"
    target_path: "deal.parties[0].employment[0].business_phone"
    
  - id: years_on_job
    type: regex
    pattern: '(3Y6M)'
    group: 1
    key: "urla_years_on_job"
    target_path: "deal.parties[0].employment[0].years_on_job"
    
  - id: years_in_profession
    type: regex
    pattern: 'Yrs\.employed.*?this line of\s+(\d+)'
    group: 1
    key: "urla_years_in_profession"
    target_path: "deal.parties[0].employment[0].years_in_profession"
    
  # ============================================================
  # Section V: Monthly Income - CLEANED PATTERNS
  # ============================================================
  
  - id: base_employment_income
    type: regex
    pattern: 'Base Empl\. Income\*\s+(1,733\.00)'
    group: 1
    key: "urla_base_employment_income"
    target_path: "deal.parties[0].employment[0].monthly_income.base"
    transform: clean_currency
    
  - id: overtime_income
    type: regex
    pattern: 'Overtime\s+(580\.00)'
    group: 1
    key: "urla_overtime_income"
    target_path: "deal.parties[0].employment[0].monthly_income.overtime"
    transform: clean_currency
    
  - id: total_monthly_income
    type: regex
    pattern: 'Total\s+(2,313\.00)'
    group: 1
    key: "urla_total_monthly_income"
    target_path: "deal.parties[0].employment[0].monthly_income.total"
    transform: clean_currency
    
  - id: proposed_first_mortgage
    type: regex
    pattern: 'First Mortgage.*?(350\.19)'
    group: 1
    key: "urla_proposed_first_mortgage"
    target_path: "deal.housing_expense.proposed.first_mortgage"
    transform: clean_currency
    
  - id: hazard_insurance
    type: regex
    pattern: 'Hazard Insurance\s+(70\.00)'
    group: 1
    key: "urla_hazard_insurance"
    target_path: "deal.housing_expense.proposed.hazard_insurance"
    transform: clean_currency
    
  - id: real_estate_taxes
    type: regex
    pattern: 'Real Estate Taxes\s+(12\.00)'
    group: 1
    key: "urla_real_estate_taxes"
    target_path: "deal.housing_expense.proposed.real_estate_taxes"
    transform: clean_currency
    
  - id: mortgage_insurance
    type: regex
    pattern: 'MortgageInsurance\s+(49\.18)'
    group: 1
    key: "urla_mortgage_insurance"
    target_path: "deal.housing_expense.proposed.mortgage_insurance"
    transform: clean_currency
    
  - id: total_proposed_housing_expense
    type: regex
    pattern: '(481\.37)'
    group: 1
    key: "urla_total_proposed_housing_expense"
    target_path: "deal.housing_expense.proposed.total"
    transform: clean_currency
    
  # ============================================================
  # Section VI: Assets and Liabilities - CLEANED PATTERNS
  # ============================================================
  
  - id: cash_deposit
    type: regex
    pattern: '(4,000\.00)'
    group: 1
    key: "urla_cash_deposit"
    target_path: "deal.assets.cash_deposit"
    transform: clean_currency
    
  - id: total_monthly_payments
    type: regex
    pattern: 'Total Monthly Payments\s+(862\.00)'
    group: 1
    key: "urla_total_monthly_payments"
    target_path: "deal.liabilities.total_monthly_payments"
    transform: clean_currency
    
  - id: total_liabilities
    type: regex
    pattern: 'Total Liabilities b\.\s+(29,697\.00)'
    group: 1
    key: "urla_total_liabilities"
    target_path: "deal.liabilities.total_liabilities"
    transform: clean_currency
    
  - id: net_worth
    type: regex
    pattern: 'NetWorth\s+(-25,697\.00)'
    group: 1
    key: "urla_net_worth"
    target_path: "deal.financial_summary.net_worth"
    transform: clean_currency_negative
    
  # ============================================================
  # Section VII: Transaction Details - CLEANED PATTERNS
  # ============================================================
  
  - id: purchase_price
    type: regex
    pattern: 'Purchase Price\s+(72,500\.00)'
    group: 1
    key: "urla_purchase_price"
    target_path: "deal.transaction_information.purchase_price"
    transform: clean_currency
    
  - id: estimated_prepaid_items
    type: regex
    pattern: 'Estimated prepaid items\s+(1,210\.33)'
    group: 1
    key: "urla_estimated_prepaid"
    target_path: "deal.transaction_information.estimated_prepaid_items"
    transform: clean_currency
    
  - id: estimated_closing_costs
    type: regex
    pattern: 'Estimated closing costs\s+(6,311\.00)'
    group: 1
    key: "urla_estimated_closing_costs"
    target_path: "deal.transaction_information.estimated_closing_costs"
    transform: clean_currency
    
  - id: pmi_mip_funding_fee
    type: regex
    pattern: 'PMI, MIP, Funding Fee\s+(1,224\.34)'
    group: 1
    key: "urla_pmi_funding_fee"
    target_path: "deal.transaction_information.pmi_funding_fee"
    transform: clean_currency
